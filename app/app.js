"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(){angular.module("dotaQuiz",["ui.router","ngResource","ngStorage","Lodash"])}(),function(){function t(t,e){var a={url:"/",controller:"AppController as appCtrl",templateUrl:"app/app.html"};t.state("app",a),e.otherwise("/")}t.$inject=["$stateProvider","$urlRouterProvider"],angular.module("dotaQuiz").config(t)}(),function(){function t(t){function e(){return t(a+"/quiz/random")}var a="/api",n={Quiz:e()};return n}t.$inject=["$resource"],angular.module("dotaQuiz").factory("API",t)}(),function(){function t(){}angular.module("dotaQuiz").controller("AppController",t)}();var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();!function(){var t=[{target:"Medallion of Courage",wrong:["Broadsword","Robe of the Magi","Talisman of Evasion"]},{target:"Solar Crest",wrong:["Broadsword","Robe of the Magi","Chainmail","Sage's Mask","Recipe"]}],e=[{name:"Recipe"},{name:"Broadsword"},{name:"Robe of the Magi"},{name:"Chainmail"},{name:"Sage's Mask"},{name:"Talisman of Evasion"},{name:"Blade Mail",requirements:["Broadsword","Chainmail","Robe of the Magi"]},{name:"Medallion of Courage",requirements:["Chainmail","Sage's Mask","Recipe"]},{name:"Solar Crest",requirements:["Medallion of Courage","Talisman of Evasion"]}],a=function(){function a(n,r){_classCallCheck(this,a),this._=n,this.API=r,this.quiz=t,this.items=e,this.USER_API=!1}return a.$inject=["_","API"],_createClass(a,[{key:"getRandomQuiz",value:function(){var t=this;return this.USER_API?(console.log("getting random quiz from api..."),this.API.Quiz.query().$promise.then(function(t){return t[0]})):(console.log("getting random quiz from local..."),new Promise(function(e){var a=_.cloneDeep(t._.sample(t.quiz));a.target=t.getItem(a.target),a.target.requirements.forEach(function(e,n){a.target.requirements[n]=t.getItem(e)}),a.wrong.forEach(function(e,n){a.wrong[n]=t.getItem(e)}),e(a)}))}},{key:"getItem",value:function(t){return _.cloneDeep(this._.find(this.items,{name:t}))}}]),a}();angular.module("dotaQuiz").service("DataService",a)}(),function(){function t(t){return t._}t.$inject=["$window"],angular.module("Lodash",[]).factory("_",t)}(),function(){function t(t){function e(){t.start()}var a=this;a.data=t.data,a.select=t.select,a.unselect=t.unselect,e()}t.$inject=["QuizFactory"],angular.module("dotaQuiz").component("quiz",{controller:t,templateUrl:"quiz/quiz.html"})}(),function(){function t(t,e,a,n,r,o){function i(){r.start(),angular.isDefined(o.getData())?(t.info("using data from $localStorage..."),a.assign(w.data,o.getData())):l()}function u(){r.reset(),l()}function c(t){if(!t.selected){for(var e in w.data.answers)if(w.data.answers[e].unknown===!0){t.selected=!0,w.data.answers[e]=t;break}d()&&m()}}function s(t){var e=w.data.answers[t];if(!e.unknown){e.selected=!1;var n=!0,r=!1,o=void 0;try{for(var i,u=w.data.choices[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var c=i.value;c.index===e.index&&(c.selected=!1)}}catch(s){r=!0,o=s}finally{try{!n&&u["return"]&&u["return"]()}finally{if(r)throw o}}w.data.answers[t]=a.cloneDeep(p)}}function l(){t.info("fetching a new quiz..."),n.getRandomQuiz().then(function(t){f(t),n.USER_API||e.$digest()})}function f(t){t.target.icon=g(t.target.name);var e=t.target.requirements.map(function(t){return a.cloneDeep(p)}),n=a.shuffle(a.concat(t.target.requirements,t.wrong));n.forEach(function(t,e){t.icon=g(t.name),t.index=e}),w.data.target=t.target,w.data.answers=e,w.data.choices=n,o.setData(w.data)}function g(t){var e=t.toLowerCase().replace(/ /g,"_");return"assets/images/icon/"+e+".png"}function d(){var t=!0;return w.data.answers.forEach(function(e){e.unknown===!0&&(t=!1)}),t}function m(){var t=a.sortBy(w.data.answers.map(function(t){return t.name}),function(t){return t}),e=a.sortBy(w.data.target.requirements.map(function(t){return t.name}),function(t){return t}),n=a.isEqual(t,e);n?h():v()}function h(){t.info("correct answer!"),r.correct(),l()}function v(){t.info("wrong answer. :(");var e=r.incorrect();0>=e&&(alert("Final Score: "+r.getScore()),u())}var p={icon:"assets/images/icon/unknown.png",alt:"Unknown Icon",unknown:!0},w={select:c,unselect:s,start:i,data:{}};return w}t.$inject=["$log","$rootScope","_","DataService","StatsFactory","StorageService"],angular.module("dotaQuiz").factory("QuizFactory",t)}(),function(){function t(t){var e=this;e.data=t.data}t.$inject=["StatsFactory"],angular.module("dotaQuiz").component("stats",{controller:t,templateUrl:"stats/stats.html"})}(),function(){function t(t,e){function a(){angular.isUndefined(e.getStats())?e.setStats(u):t.info("using stats from $localStorage..."),c.data=e.getStats()}function n(){_.assign(c.data,u)}function r(){return c.data.guesses-=1,c.data.inRow=0,c.data.guesses}function o(){var t=200,e=30;c.data.score+=t+e*c.data.inRow,c.data.inRow+=1}function i(){return c.data.score}var u={inRow:0,score:0,guesses:3},c={start:a,reset:n,correct:o,incorrect:r,getScore:i,data:{}};return c}t.$inject=["$log","StorageService"],angular.module("dotaQuiz").factory("StatsFactory",t)}();var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();!function(){var t=function(){function t(e){_classCallCheck(this,t),this.$localStorage=e}return t.$inject=["$localStorage"],_createClass(t,[{key:"getStats",value:function(){return this.$localStorage.stats}},{key:"setStats",value:function(t){this.$localStorage.stats=t}},{key:"deleteStats",value:function(){delete this.$localStorage.stats}},{key:"getData",value:function(){return this.$localStorage.data}},{key:"setData",value:function(t){this.$localStorage.data=t}},{key:"deleteData",value:function(){delete this.$localStorage.data}}]),t}();angular.module("dotaQuiz").service("StorageService",t)}();
//# sourceMappingURL=../maps/app.js.map
