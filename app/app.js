"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){angular.module("dotaQuiz",["ui.router","ngResource","ngStorage","Lodash"])}(),function(){function e(e,t){var n={url:"/",controller:"AppController as appCtrl",templateUrl:"app/app.html"};e.state("app",n),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("dotaQuiz").config(e)}(),function(){function e(e){function t(){return e(n+"/quiz/random")}var n="/api",a={Quiz:t()};return a}e.$inject=["$resource"],angular.module("dotaQuiz").factory("API",e)}(),function(){function e(){}angular.module("dotaQuiz").controller("AppController",e)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();!function(){var e=[{name:"Abyssal Blade",requirements:["Sacred Relic","Skull Basher"]},{name:"Aether Lens",requirements:["Recipe","Energy Booster","Ring of Health"]},{name:"Aghanim's Scepter",requirements:["Point Booster","Ogre Club","Blade of Alacrity","Staff of Wizardry"]},{name:"Arcane Boots",requirements:["Boots of Speed","Energy Booster"]},{name:"Armlet of Mordiggian",requirements:["Helm of Iron Will","Gloves of Haste","Blades of Attack","Recipe"]},{name:"Assault Cuirass",requirements:["Platemail","Hyperstone","Chainmail","Recipe"]},{name:"Band of Elvenskin"},{name:"Battle Fury",requirements:["Claymore","Broadsword","Perseverance","Quelling Blade"]},{name:"Belt of Strength"},{name:"Black King Bar",requirements:["Mithril Hammer","Ogre Club","Recipe"]},{name:"Blade Mail",requirements:["Broadsword","Chainmail","Robe of the Magi"]},{name:"Blade of Alacrity"},{name:"Blades of Attack"},{name:"Blink Dagger"},{name:"Bloodstone",requirements:["Soul Booster","Soul Ring","Recipe"]},{name:"Boots of Speed"},{name:"Boots of Travel",requirements:["Boots of Speed","Recipe"]},{name:"Bracer",requirements:["Circlet","Gauntlets of Strength","Recipe"]},{name:"Broadsword"},{name:"Buckler",requirements:["Chainmail","Iron Branch","Recipe"]},{name:"Butterfly",requirements:["Eaglesong","Talisman of Evasion","Quarterstaff"]},{name:"Chainmail"},{name:"Circlet"},{name:"Claymore"},{name:"Cloak"},{name:"Crimson Guard",requirements:["Vanguard","Buckler","Recipe"]},{name:"Crystalys",requirements:["Broadsword","Blades of Attack","Recipe"]},{name:"Daedalus",requirements:["Crystalys","Demon Edge","Recipe"]},{name:"Dagon 1",requirements:["Staff of Wizardry","Null Talisman","Recipe"]},{name:"Dagon 2",requirements:["Dagon 1","Recipe"]},{name:"Dagon 3",requirements:["Dagon 2","Recipe"]},{name:"Dagon 4",requirements:["Dagon 3","Recipe"]},{name:"Dagon 5",requirements:["Dagon 4","Recipe"]},{name:"Demon Edge"},{name:"Desolator",requirements:["Mithril Hammer","Mithril Hammer","Recipe"]},{name:"Diffusal Blade 1",requirements:["Blade of Alacrity","Blade of Alacrity","Robe of the Magi","Recipe"]},{name:"Diffusal Blade 2",requirements:["Diffusal Blade 1","Recipe"]},{name:"Divine Rapier",requirements:["Sacred Relic","Demon Edge"]},{name:"Dragon Lance",requirements:["Ogre Club","Quarterstaff"]},{name:"Drum of Endurance",requirements:["Bracer","Robe of the Magi","Recipe"]},{name:"Eaglesong"},{name:"Energy Booster"},{name:"Ethereal Blade",requirements:["Eaglesong","Ghost Scepter"]},{name:"Eul's Scepter of Divinity",requirements:["Staff of Wizardry","Sage's Mask","Void Stone","Recipe"]},{name:"Eye of Skadi",requirements:["Ultimate Orb","Ultimate Orb","Point Booster","Orb of Venom"]},{name:"Force Staff",requirements:["Staff of Wizardry","Ring of Regen","Recipe"]},{name:"Gauntlets of Strength"},{name:"Ghost Scepter"},{name:"Glimmer Cape",requirements:["Shadow Amulet","Cloak"]},{name:"Gloves of Haste"},{name:"Guardian Greaves",requirements:["Mekansm","Arcane Boots","Recipe"]},{name:"Hand of Midas",requirements:["Gloves of Haste","Recipe"]},{name:"Headdress",requirements:["Ring of Regen","Iron Branch","Recipe"]},{name:"Heart of Tarrasque",requirements:["Reaver","Vitality Booster","Recipe"]},{name:"Heaven's Halberd",requirements:["Sange","Talisman of Evasion"]},{name:"Helm of Iron Will"},{name:"Helm of The Dominator",requirements:["Helm of Iron Will","Morbid Mask"]},{name:"Hood of Defiance",requirements:["Ring of Health","Cloak","Ring of Regen","Ring of Regen"]},{name:"Hyperstone"},{name:"Iron Branch"},{name:"Iron Talon",requirements:["Quelling Blade","Ring of Protection","Recipe"]},{name:"Javelin"},{name:"Linken's Sphere",requirements:["Perseverance","Ultimate Orb","Recipe"]},{name:"Lotus Orb",requirements:["Perseverance","Platemail","Recipe"]},{name:"Maelstrom",requirements:["Mithril Hammer","Gloves of Haste","Recipe"]},{name:"Magic Stick"},{name:"Magic Wand",requirements:["Magic Stick","Iron Branch","Iron Branch","Circlet"]},{name:"Manta Style",requirements:["Ultimate Orb","Yasha","Recipe"]},{name:"Mantle of Intelligence"},{name:"Mask of Madness",requirements:["Morbid Mask","Recipe"]},{name:"Medallion of Courage",requirements:["Chainmail","Sage's Mask","Recipe"]},{name:"Mekansm",requirements:["Buckler","Headdress","Recipe"]},{name:"Mithril Hammer"},{name:"Mjollnir",requirements:["Hyperstone","Maelstrom","Recipe"]},{name:"Monkey King Bar",requirements:["Javelin","Javelin","Demon Edge"]},{name:"Moon Shard",requirements:["Hyperstone","Hyperstone"]},{name:"Morbid Mask"},{name:"Mystic Staff"},{name:"Necronomicon 1",requirements:["Staff of Wizardry","Belt of Strength","Recipe"]},{name:"Necronomicon 2",requirements:["Necronomicon 1","Recipe"]},{name:"Necronomicon 3",requirements:["Necronomicon 2","Recipe"]},{name:"Null Talisman",requirements:["Circlet","Mantle of Intelligence","Recipe"]},{name:"Oblivion Staff",requirements:["Quarterstaff","Robe of the Magi","Sage's Mask"]},{name:"Octarine Core",requirements:["Mystic Staff","Soul Booster"]},{name:"Ogre Club"},{name:"Orb of Venom"},{name:"Orchid Malevolence",requirements:["Oblivion Staff","Oblivion Staff","Recipe"]},{name:"Perseverance",requirements:["Ring of Health","Void Stone"]},{name:"Phase Boots",requirements:["Boots of Speed","Blades of Attack","Blades of Attack"]},{name:"Pipe of Insight",requirements:["Hood of Defiance","Headdress","Recipe"]},{name:"Platemail"},{name:"Point Booster"},{name:"Poor Man's Shield",requirements:["Stout Shield","Slippers of Agility","Slippers of Agility"]},{name:"Power Treads Agi",requirements:["Boots of Speed","Gloves of Haste","Band of Elvenskin"]},{name:"Power Treads Str",requirements:["Boots of Speed","Gloves of Haste","Belt of Strength"]},{name:"Power Treads Int",requirements:["Boots of Speed","Gloves of Haste","Robe of the Magi"]},{name:"Quarterstaff"},{name:"Quelling Blade"},{name:"Radiance",requirements:["Sacred Relic","Recipe"]},{name:"Reaver"},{name:"Recipe"},{name:"Refresher Orb",requirements:["Perseverance","Perseverance","Recipe"]},{name:"Ring of Aquila",requirements:["Wraith Band","Ring of Basilius"]},{name:"Ring of Basilius",requirements:["Sage's Mask","Ring of Protection"]},{name:"Ring of Health"},{name:"Ring of Protection"},{name:"Ring of Regen"},{name:"Robe of The Magi"},{name:"Rod of Atos",requirements:["Staff of Wizardry","Staff of Wizardry","Vitality Booster"]},{name:"Sacred Relic"},{name:"Sage's Mask"},{name:"Sange",requirements:["Ogre Club","Belt of Strength","Recipe"]},{name:"Sange And Yasha",requirements:["Sange","Yasha"]},{name:"Satanic",requirements:["Reaver","Helm of the Dominator","Recipe"]},{name:"Scythe of Vyse",requirements:["Mystic Staff","Ultimate Orb","Void Stone"]},{name:"Shadow Amulet"},{name:"Shadow Blade",requirements:["Claymore","Shadow Amulet"]},{name:"Shiva's Guard",requirements:["Mystic Staff","Platemail","Recipe"]},{name:"Silver Edge",requirements:["Shadow Blade","Sange","Recipe"]},{name:"Skull Basher",requirements:["Javelin","Belt of Strength","Recipe"]},{name:"Slippers of Agility"},{name:"Solar Crest",requirements:["Medallion of Courage","Talisman of Evasion"]},{name:"Soul Booster",requirements:["Point Booster","Vitality Booster","Energy Booster"]},{name:"Soul Ring",requirements:["Ring of Regen","Sage's Mask","Recipe"]},{name:"Staff of Wizardry"},{name:"Stout Shield"},{name:"Talisman of Evasion"},{name:"Tranquil Boots",requirements:["Boots of Speed","Ring of Protection","Ring of Regen"]},{name:"Ultimate Orb"},{name:"Urn of Shadows",requirements:["Sage's Mask","Gauntlets of Strength","Gauntlets of Strength","Recipe"]},{name:"Vanguard",requirements:["Ring of Health","Vitality Booster","Stout Shield"]},{name:"Veil of Discord",requirements:["Helm of Iron Will","Null Talisman","Robe of the Magi","Robe of the Magi"]},{name:"Vitality Booster"},{name:"Vladmir's Offering",requirements:["Morbid Mask","Ring of Basilius","Headdress","Recipe"]},{name:"Void Stone"},{name:"Wraith Band",requirements:["Circlet","Slippers of Agility","Recipe"]},{name:"Yasha",requirements:["Blade of Alacrity","Band of Elvenskin","Recipe"]}],t=function(){function t(n,a,r){_classCallCheck(this,t),this._=n,this.API=a,this.items=e,this.StorageService=r,this.itemsWithRequirements=r.getQuizLeft(),0===this.itemsWithRequirements.length&&(this.StorageService.setQuizLeft(this._.shuffle(this.items.filter(function(e){return e.requirements&&e.requirements.length>0}))),this.itemsWithRequirements=this.StorageService.getQuizLeft()),this.USER_API=!1}return t.$inject=["_","API","StorageService"],_createClass(t,[{key:"getRandomQuiz",value:function(){var e=this;return this.USER_API?(console.log("getting random quiz from api..."),this.API.Quiz.query().$promise.then(function(e){return e[0]})):(console.log("getting random quiz from local...:",this.itemsWithRequirements.length),new Promise(function(t){var n=_.cloneDeep(e.itemsWithRequirements.pop()),a=_.cloneDeep(e._.sampleSize(e._.reject(e.items,function(e){return e.name===n.name}),9-n.requirements.length)),r={target:n,wrong:a};r.target.requirements.forEach(function(t,n){r.target.requirements[n]=e.getItem(t)}),t(r)}))}},{key:"getItem",value:function(e){var t=_.cloneDeep(this._.find(this.items,function(t){return t.name.toLowerCase()===e.toLowerCase()}));if(!t)throw new Error("Item not found: "+e);return t}},{key:"reset",value:function(){this.StorageService.setQuizLeft(this._.shuffle(this.items.filter(function(e){return e.requirements&&e.requirements.length>0}))),this.itemsWithRequirements=this.StorageService.getQuizLeft()}}]),t}();angular.module("dotaQuiz").service("DataService",t)}(),function(){function e(e){return e._}e.$inject=["$window"],angular.module("Lodash",[]).factory("_",e)}(),function(){function e(e){function t(){e.start()}var n=this;n.data=e.data,n.select=e.select,n.unselect=e.unselect,t()}e.$inject=["QuizFactory"],angular.module("dotaQuiz").component("quiz",{controller:e,templateUrl:"quiz/quiz.html"})}(),function(){function e(e,t,n,a,r,i){function o(){r.start(),angular.isDefined(i.getData())?(e.info("using data from $localStorage..."),n.assign(q.data,i.getData())):m()}function s(){a.reset(),r.reset(),m()}function l(e){if(!e.selected){for(var t in q.data.answers)if(q.data.answers[t].unknown===!0){e.selected=!0,q.data.answers[t]=e;break}g()&&d()}}function u(e){var t=q.data.answers[e];if(!t.unknown){t.selected=!1;var a=!0,r=!1,i=void 0;try{for(var o,s=q.data.choices[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;l.index===t.index&&(l.selected=!1)}}catch(u){r=!0,i=u}finally{try{!a&&s["return"]&&s["return"]()}finally{if(r)throw i}}q.data.answers[e]=n.cloneDeep(p)}}function m(){e.info("fetching a new quiz..."),a.getRandomQuiz().then(function(e){c(e),a.USER_API||t.$digest()})}function c(e){e.target.icon=f(e.target.name);var t=e.target.requirements.map(function(e){return n.cloneDeep(p)}),a=n.shuffle(n.concat(e.target.requirements,e.wrong));a.forEach(function(e,t){e.icon=f(e.name),e.index=t}),q.data.target=e.target,q.data.answers=t,q.data.choices=a,i.setData(q.data)}function f(e){var t=e.toLowerCase().replace(/ /g,"_");return"assets/images/icon/"+t+".png"}function g(){var e=!0;return q.data.answers.forEach(function(t){t.unknown===!0&&(e=!1)}),e}function d(){var e=n.sortBy(q.data.answers.map(function(e){return e.name}),function(e){return e}),t=n.sortBy(q.data.target.requirements.map(function(e){return e.name}),function(e){return e}),a=n.isEqual(e,t);a?h():S()}function h(){e.info("correct answer!"),r.correct(),i.getQuizLeft().length>0?m():(alert("Congratulation! You finished the Quiz with: "+r.getScore()),s())}function S(){e.info("wrong answer. :(");var t=r.incorrect();0>=t&&(alert("Final Score: "+r.getScore()),s())}var p={icon:"assets/images/icon/unknown.png",alt:"Unknown Icon",unknown:!0},q={select:l,unselect:u,start:o,data:{}};return q}e.$inject=["$log","$rootScope","_","DataService","StatsFactory","StorageService"],angular.module("dotaQuiz").factory("QuizFactory",e)}(),function(){function e(e){var t=this;t.data=e.data}e.$inject=["StatsFactory"],angular.module("dotaQuiz").component("stats",{controller:e,templateUrl:"stats/stats.html"})}(),function(){function e(e,t){function n(){angular.isUndefined(t.getStats())?t.setStats(s):e.info("using stats from $localStorage..."),l.data=t.getStats()}function a(){_.assign(l.data,s)}function r(){return l.data.guesses-=1,l.data.inRow=0,l.data.guesses}function i(){var e=200,t=30;l.data.score+=e+t*l.data.inRow,l.data.inRow+=1}function o(){return l.data.score}var s={inRow:0,score:0,guesses:3},l={start:n,reset:a,correct:i,incorrect:r,getScore:o,data:{}};return l}e.$inject=["$log","StorageService"],angular.module("dotaQuiz").factory("StatsFactory",e)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();!function(){var e=function(){function e(t){_classCallCheck(this,e),this.$localStorage=t}return e.$inject=["$localStorage"],_createClass(e,[{key:"getStats",value:function(){return this.$localStorage.stats}},{key:"setStats",value:function(e){this.$localStorage.stats=e}},{key:"deleteStats",value:function(){delete this.$localStorage.stats}},{key:"getData",value:function(){return this.$localStorage.data}},{key:"setData",value:function(e){this.$localStorage.data=e}},{key:"deleteData",value:function(){delete this.$localStorage.data}},{key:"getQuizLeft",value:function(){return angular.isUndefined(this.$localStorage.quizLeft)&&(this.$localStorage.quizLeft=[]),this.$localStorage.quizLeft}},{key:"setQuizLeft",value:function(e){this.$localStorage.quizLeft=e}},{key:"deleteQuizLeft",value:function(){delete this.$localStorage.quizLeft}}]),e}();angular.module("dotaQuiz").service("StorageService",e)}();
//# sourceMappingURL=../maps/app.js.map
