"use strict";function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}!function(){angular.module("dotaQuiz",["ui.router","ngResource","ngStorage","Lodash"])}(),function(){function e(e,a){var n={url:"/",controller:"AppController as appCtrl",templateUrl:"app/app.html"};e.state("app",n),a.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("dotaQuiz").config(e)}(),function(){function e(e){function a(){return e(n+"/quiz/random")}var n="/api",t={Quiz:a()};return t}e.$inject=["$resource"],angular.module("dotaQuiz").factory("API",e)}(),function(){function e(){}angular.module("dotaQuiz").controller("AppController",e)}();var _createClass=function(){function e(e,a){for(var n=0;n<a.length;n++){var t=a[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(a,n,t){return n&&e(a.prototype,n),t&&e(a,t),a}}();!function(){var e=[{name:"Abyssal Blade",requirements:["Sacred Relic","Skull Basher"]},{name:"Aether Lens",requirements:["Recipe","Energy Booster","Ring of Health"]},{name:"Aghanim's Scepter",requirements:["Point Booster","Ogre Club","Blade of Alacrity","Staff of Wizardry"]},{name:"Arcane Boots",requirements:["Boots of Speed","Energy Booster"]},{name:"Armlet of Mordiggian",requirements:["Helm of Iron Will","Gloves of Haste","Blades of Attack","Recipe"]},{name:"Assault Cuirass",requirements:["Platemail","Hyperstone","Chainmail","Recipe"]},{name:"Band of Elvenskin"},{name:"Battle Fury",requirements:["Claymore","Broadsword","Perseverance","Quelling Blade"]},{name:"Belt of Strength"},{name:"Black King Bar",requirements:["Mithril Hammer","Ogre Club","Recipe"]},{name:"Blade Mail",requirements:["Broadsword","Chainmail","Robe of the Magi"]},{name:"Blade of Alacrity"},{name:"Blades of Attack"},{name:"Blink Dagger"},{name:"Bloodstone",requirements:["Soul Booster","Soul Ring","Recipe"]},{name:"Boots of Speed"},{name:"Boots of Travel",requirements:["Boots of Speed","Recipe"]},{name:"Bracer",requirements:["Circlet","Gauntlets of Strength","Recipe"]},{name:"Broadsword"},{name:"Buckler",requirements:["Chainmail","Iron Branch","Recipe"]},{name:"Butterfly",requirements:["Eaglesong","Talisman of Evasion","Quarterstaff"]},{name:"Chainmail"},{name:"Circlet"},{name:"Claymore"},{name:"Cloak"},{name:"Crimson Guard",requirements:["Vanguard","Buckler"," Recipe"]},{name:"Crystalys",requirements:["Broadsword","Blades of Attack"," Recipe"]},{name:"Daedalus",requirements:["Crystalys","Demon Edge","Recipe"]},{name:"Dagon",requirements:["Staff of Wizardry","Null Talisman","Recipe"]},{name:"Demon Edge"},{name:"Desolator",requirements:["Mithril Hammer","Mithril Hammer","Recipe"]},{name:"Diffusal Blade",requirements:["Blade of Alacrity","Blade of Alacrity","Robe of the Magi","Recipe"]},{name:"Divine Rapier",requirements:["Sacred Relic","Demon Edge"]},{name:"Dragon Lance",requirements:["Ogre Club","Quarterstaff"]},{name:"Drum of Endurance",requirements:["Bracer","Robe of the Magi"," Recipe"]},{name:"Eaglesong"},{name:"Energy Booster"},{name:"Ethereal Blade",requirements:["Eaglesong","Ghost Scepter"]},{name:"Eul's Scepter of Divinity",requirements:["Staff of Wizardry","Sage's Mask","Void Stone","Recipe"]},{name:"Eye of Skadi",requirements:["Ultimate Orb","Ultimate Orb","Point Booster","Orb of Venom"]},{name:"Force Staff",requirements:["Staff of Wizardry","Ring of Regen","Recipe"]},{name:"Gauntlets of Strength"},{name:"Ghost Scepter"},{name:"Glimmer Cape",requirements:["Shadow Amulet","Cloak"]},{name:"Gloves of Haste"},{name:"Guardian Greaves",requirements:["Mekansm","Arcane Boots","Recipe"]},{name:"Hand of Midas",requirements:["Gloves of Haste","Recipe"]},{name:"Headdress",requirements:["Ring of Regen","Iron Branch","Recipe"]},{name:"Heart of Tarrasque",requirements:["Reaver","Vitality Booster","Recipe"]},{name:"Heaven's Halberd",requirements:["Sange","Talisman of Evasion"]},{name:"Helm of Iron Will"},{name:"Helm of The Dominator",requirements:["Helm of Iron Will","Morbid Mask"]},{name:"Hood of Defiance",requirements:["Ring of Health","Cloak","Ring of Regen","Ring of Regen"]},{name:"Hyperstone"},{name:"Iron Branch"},{name:"Iron Talon",requirements:["Quelling Blade","Ring of Protection","Recipe"]},{name:"Javelin"},{name:"Linken's Sphere",requirements:["Perseverance","Ultimate Orb","Recipe"]},{name:"Lotus Orb",requirements:["Perseverance","Platemail","Recipe"]},{name:"Maelstrom",requirements:["Mithril Hammer","Gloves of Haste","Recipe"]},{name:"Magic Stick"},{name:"Magic Wand",requirements:["Magic Stick","Iron Branch","Iron Branch","Circlet"]},{name:"Manta Style",requirements:["Ultimate Orb","Yasha","Recipe"]},{name:"Mantle of Intelligence"},{name:"Mask of Madness",requirements:["Morbid Mask","Recipe"]},{name:"Medallion of Courage",requirements:["Chainmail","Sage's Mask","Recipe"]},{name:"Mekansm",requirements:["Buckler","Headdress","Recipe"]},{name:"Mithril Hammer"},{name:"Mjollnir",requirements:["Hyperstone","Maelstrom","Recipe"]},{name:"Monkey King Bar",requirements:["Javelin","Javelin","Demon Edge"]},{name:"Moon Shard",requirements:["Hyperstone","Hyperstone"]},{name:"Morbid Mask"},{name:"Mystic Staff"},{name:"Necronomicon",requirements:["Staff of Wizardry","Belt of Strength","Recipe"]},{name:"Null Talisman",requirements:["Circlet","Mantle of Intelligence","Recipe"]},{name:"Oblivion Staff",requirements:["Quarterstaff","Robe of the Magi","Sage's Mask"]},{name:"Octarine Core",requirements:["Mystic Staff","Soul Booster"]},{name:"Ogre Club"},{name:"Orb of Venom"},{name:"Orchid Malevolence",requirements:["Oblivion Staff","Oblivion Staff","Recipe"]},{name:"Perseverance",requirements:["Ring of Health","Void Stone"]},{name:"Phase Boots",requirements:["Boots of Speed","Blades of Attack","Blades of Attack"]},{name:"Pipe of Insight",requirements:["Hood of Defiance","Headdress","Recipe"]},{name:"Platemail"},{name:"Point Booster"},{name:"Poor Man's Shield",requirements:["Stout Shield","Slippers of Agility","Slippers of Agility"]},{name:"Power Treads Agi",requirements:["Boots of Speed","Gloves of Haste","Band of Elvenskin"]},{name:"Power Treads Str",requirements:["Boots of Speed","Gloves of Haste","Belt of Strength"]},{name:"Power Treads Int",requirements:["Boots of Speed","Gloves of Haste","Robe of the Magi"]},{name:"Quarterstaff"},{name:"Quelling Blade"},{name:"Radiance",requirements:["Sacred Relic","Recipe"]},{name:"Reaver"},{name:"Recipe"},{name:"Refresher Orb",requirements:["Perseverance","Perseverance","Recipe"]},{name:"Ring of Aquila",requirements:["Wraith Band","Ring of Basilius"]},{name:"Ring of Basilius",requirements:["Sage's Mask","Ring of Protection"]},{name:"Ring of Health"},{name:"Ring of Protection"},{name:"Ring of Regen"},{name:"Robe of The Magi"},{name:"Rod of Atos",requirements:["Staff of Wizardry","Staff of Wizardry","Vitality Booster"]},{name:"Sacred Relic"},{name:"Sage's Mask"},{name:"Sange",requirements:["Ogre Club","Belt of Strength","Recipe"]},{name:"Sange And Yasha",requirements:["Sange","Yasha"]},{name:"Satanic",requirements:["Reaver","Helm of the Dominator","Recipe"]},{name:"Scythe of Vyse",requirements:["Mystic Staff","Ultimate Orb","Void Stone"]},{name:"Shadow Amulet"},{name:"Shadow Blade",requirements:["Claymore","Shadow Amulet"]},{name:"Shiva's Guard",requirements:["Mystic Staff","Platemail","Recipe"]},{name:"Silver Edge",requirements:["Shadow Blade","Sange","Recipe"]},{name:"Skull Basher",requirements:["Javelin","Belt of Strength","Recipe"]},{name:"Slippers of Agility"},{name:"Solar Crest",requirements:["Medallion of Courage","Talisman of Evasion"]},{name:"Soul Booster",requirements:["Point Booster","Vitality Booster","Energy Booster"]},{name:"Soul Ring",requirements:["Ring of Regen","Sage's Mask","Recipe"]},{name:"Staff of Wizardry"},{name:"Stout Shield"},{name:"Talisman of Evasion"},{name:"Tranquil Boots",requirements:["Boots of Speed","Ring of Protection","Ring of Regen"]},{name:"Ultimate Orb"},{name:"Urn of Shadows",requirements:["Sage's Mask","Gauntlets of Strength","Gauntlets of Strength","Recipe"]},{name:"Vanguard",requirements:["Ring of Health","Vitality Booster","Stout Shield"]},{name:"Veil of Discord",requirements:["Helm of Iron Will","Null Talisman","Robe of the Magi","Robe of the Magi"]},{name:"Vitality Booster"},{name:"Vladmir's Offering",requirements:["Morbid Mask","Ring of Basilius","Headdress","Recipe"]},{name:"Void Stone"},{name:"Wraith Band",requirements:["Circlet","Slippers of Agility","Recipe"]},{name:"Yasha",requirements:["Blade of Alacrity","Band of Elvenskin","Recipe"]}],a=function(){function a(n,t){_classCallCheck(this,a),this._=n,this.API=t,this.items=e,this.itemsWithRequirements=this.items.filter(function(e){return e.requirements&&e.requirements.length>0}),this.USER_API=!1}return a.$inject=["_","API"],_createClass(a,[{key:"getRandomQuiz",value:function(){var e=this;return this.USER_API?(console.log("getting random quiz from api..."),this.API.Quiz.query().$promise.then(function(e){return e[0]})):(console.log("getting random quiz from local..."),new Promise(function(a){var n=_.cloneDeep(e._.sample(e.itemsWithRequirements)),t=_.cloneDeep(e._.sampleSize(e._.reject(e.items,function(e){return e.name===n.name}),9-n.requirements.length)),r={target:n,wrong:t};r.target.requirements.forEach(function(a,n){r.target.requirements[n]=e.getItem(a)}),a(r)}))}},{key:"getItem",value:function(e){var a=_.cloneDeep(this._.find(this.items,function(a){return a.name.toLowerCase()===e.toLowerCase()}));if(!a)throw new Error("Item not found: "+e);return a}}]),a}();angular.module("dotaQuiz").service("DataService",a)}(),function(){function e(e){return e._}e.$inject=["$window"],angular.module("Lodash",[]).factory("_",e)}(),function(){function e(e){function a(){e.start()}var n=this;n.data=e.data,n.select=e.select,n.unselect=e.unselect,a()}e.$inject=["QuizFactory"],angular.module("dotaQuiz").component("quiz",{controller:e,templateUrl:"quiz/quiz.html"})}(),function(){function e(e,a,n,t,r,i){function o(){r.start(),angular.isDefined(i.getData())?(e.info("using data from $localStorage..."),n.assign(R.data,i.getData())):u()}function s(){r.reset(),u()}function l(e){if(!e.selected){for(var a in R.data.answers)if(R.data.answers[a].unknown===!0){e.selected=!0,R.data.answers[a]=e;break}d()&&g()}}function m(e){var a=R.data.answers[e];if(!a.unknown){a.selected=!1;var t=!0,r=!1,i=void 0;try{for(var o,s=R.data.choices[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var l=o.value;l.index===a.index&&(l.selected=!1)}}catch(m){r=!0,i=m}finally{try{!t&&s["return"]&&s["return"]()}finally{if(r)throw i}}R.data.answers[e]=n.cloneDeep(p)}}function u(){e.info("fetching a new quiz..."),t.getRandomQuiz().then(function(e){c(e),t.USER_API||a.$digest()})}function c(e){e.target.icon=f(e.target.name);var a=e.target.requirements.map(function(e){return n.cloneDeep(p)}),t=n.shuffle(n.concat(e.target.requirements,e.wrong));t.forEach(function(e,a){e.icon=f(e.name),e.index=a}),R.data.target=e.target,R.data.answers=a,R.data.choices=t,i.setData(R.data)}function f(e){var a=e.toLowerCase().replace(/ /g,"_");return"assets/images/icon/"+a+".png"}function d(){var e=!0;return R.data.answers.forEach(function(a){a.unknown===!0&&(e=!1)}),e}function g(){var e=n.sortBy(R.data.answers.map(function(e){return e.name}),function(e){return e}),a=n.sortBy(R.data.target.requirements.map(function(e){return e.name}),function(e){return e}),t=n.isEqual(e,a);t?S():h()}function S(){e.info("correct answer!"),r.correct(),u()}function h(){e.info("wrong answer. :(");var a=r.incorrect();0>=a&&(alert("Final Score: "+r.getScore()),s())}var p={icon:"assets/images/icon/unknown.png",alt:"Unknown Icon",unknown:!0},R={select:l,unselect:m,start:o,data:{}};return R}e.$inject=["$log","$rootScope","_","DataService","StatsFactory","StorageService"],angular.module("dotaQuiz").factory("QuizFactory",e)}(),function(){function e(e){var a=this;a.data=e.data}e.$inject=["StatsFactory"],angular.module("dotaQuiz").component("stats",{controller:e,templateUrl:"stats/stats.html"})}(),function(){function e(e,a){function n(){angular.isUndefined(a.getStats())?a.setStats(s):e.info("using stats from $localStorage..."),l.data=a.getStats()}function t(){_.assign(l.data,s)}function r(){return l.data.guesses-=1,l.data.inRow=0,l.data.guesses}function i(){var e=200,a=30;l.data.score+=e+a*l.data.inRow,l.data.inRow+=1}function o(){return l.data.score}var s={inRow:0,score:0,guesses:3},l={start:n,reset:t,correct:i,incorrect:r,getScore:o,data:{}};return l}e.$inject=["$log","StorageService"],angular.module("dotaQuiz").factory("StatsFactory",e)}();var _createClass=function(){function e(e,a){for(var n=0;n<a.length;n++){var t=a[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(a,n,t){return n&&e(a.prototype,n),t&&e(a,t),a}}();!function(){var e=function(){function e(a){_classCallCheck(this,e),this.$localStorage=a}return e.$inject=["$localStorage"],_createClass(e,[{key:"getStats",value:function(){return this.$localStorage.stats}},{key:"setStats",value:function(e){this.$localStorage.stats=e}},{key:"deleteStats",value:function(){delete this.$localStorage.stats}},{key:"getData",value:function(){return this.$localStorage.data}},{key:"setData",value:function(e){this.$localStorage.data=e}},{key:"deleteData",value:function(){delete this.$localStorage.data}}]),e}();angular.module("dotaQuiz").service("StorageService",e)}();
//# sourceMappingURL=../maps/app.js.map
